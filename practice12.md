## Практическая работа 12

### Диаграмма


>![Результат 1](/arh.png)

### API Gateway

1. API Gateway Клиентов и Дистрибьюторов (APIGW_Customers):

**Функционал**: Аутентификация/Авторизация, управление профилями пользователей, маршрутизация запросов.

**Добавлено**:  Identity Provider (IdP).  Теперь аутентификация и авторизация вынесены в отдельный компонент (например, Keycloak, Auth0). APIGW_Customers делегирует аутентификацию IdP и получает JWT (JSON Web Token) для авторизации.

**Обоснование**: Централизованное управление идентификацией и доступом, упрощение интеграции с другими сервисами.

**Качество**: Задержка аутентификации < 100 мс, поддержка Multi-Factor Authentication (MFA).

2. API Gateway Каталога и Заказов (APIGW_Catalog_Orders):

**Функционал**: Предоставление API для просмотра каталога, оформления заказов, управления клиентскими предложениями. Авторизация на основе токенов, полученных от IdP.
Обоснование:  Разделение ответственности.  Этот шлюз отвечает только за логику, связанную с каталогом и заказами.
**Качество**:  Время отклика API < 200 мс, поддержка кэширования для часто запрашиваемых товаров.

3. API Gateway Складов Готовой Продукции и IoT (APIGW_Warehouse_IoT):

**Функционал**:  Прием данных от сканеров кодов, обновление информации о запасах, предоставление API для запроса информации о складе.

**Добавлено**:  Очередь сообщений (Message Queue, Warehouse_MQ) (например, Kafka, RabbitMQ).

**Обоснование**:  Асинхронная обработка данных от IoT-устройств. Сканеры кодов отправляют сообщения в очередь, а сервис складов потребляет их и обновляет данные. Это позволяет обрабатывать большие объемы данных с низкой задержкой и обеспечивает отказоустойчивость.
Качество:  Обработка > 1000 сообщений в секунду, задержка обработки < 100 мс.

4. API Gateway Логистики (APIGW_Logistics):

**Функционал**:  Предоставление API для отслеживания грузов, управления доставкой, интеграция с транспортными компаниями.

**Обоснование**:  Унифицированный интерфейс для работы с логистикой.

**Качество**:  Поддержка интеграции с различными службами доставки, время отклика API < 300 мс.

5. API Gateway Производства и Складов Материалов (APIGW_Production_Materials):

**Функционал**:  Прием данных от датчиков станков, управление производственным процессом, контроль качества, управление запасами материалов.

**Добавлено**:  Очередь сообщений (Message Queue, Production_MQ) (например, Kafka, RabbitMQ).

**Обоснование**:  Аналогично складам готовой продукции, использование очереди сообщений позволяет асинхронно обрабатывать данные от датчиков станков и других IoT-устройств, обеспечивая высокую пропускную способность и отказоустойчивость.

**Качество**:  Обработка > 5000 сообщений в секунду, интеграция с системами управления производством (MES), поддержка Real-time аналитики.

#### Дополнительные компоненты и изменения:

**Система аналитики и отчетности (Analytics)**:  Собирает данные из всех подсистем (через очереди сообщений) и предоставляет инструменты для анализа и построения отчетов.

**Основная база данных (DB):**  Хранит данные всех подсистем.

**Связи между API Gateway и IdP:**  Важный элемент для обеспечения безопасности и централизованного управления доступом.

#### Ключевые улучшения:

**Асинхронная обработка данных IoT:**  Использование очередей сообщений для обработки данных от IoT-устройств обеспечивает высокую пропускную способность и отказоустойчивость.

**Централизованное управление идентификацией и доступом:**  IdP упрощает управление пользователями и правами доступа.

**Разделение ответственности:**  Каждый API Gateway отвечает за конкретную область, что упрощает разработку, тестирование и масштабирование.

**Аналитика:**  Сбор и анализ данных из всех подсистем позволяет принимать обоснованные решения на основе данных.

Данная архитектура обеспечивает гибкость, масштабируемость и безопасность, необходимые для поддержки растущей сети пользователей, дистрибьюторов и IoT-устройств.  Использование API Gateway позволяет унифицировать доступ к сервисам, обеспечить защиту от несанкционированного доступа и упростить интеграцию новых сервисов.